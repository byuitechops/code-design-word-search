(function(){
  const puzzles = {
    "Four by Four":{
      puzzle:["abcd","efgh","ijkl","mnop"],
      words:['abc','dhl','pon','mie','jg','kf']
    },
    "Five by Five":{
      puzzle:["nsddw","acros","edewt","lmont","cvest"],
      words:['acros','cent','down','clean','dot','soda','as','vow','meow','vest','law']
    },
    "Three by Seven":{
      puzzle:["abcdefg","hijklmn","opqrstv"],
      words:["AIQ","PJD","SKC","RLF","OHA","GNV","STV","GFE"]
    },
    "Medium":{
      puzzle:["VRCVMNFAJSEDICBOPOHETZKNAAAWYN","YIZPGOZNVLEJAQAPFBLBNVYRRYQTKI","WVXDRIHTAMRETFANEFYMWVPWDOIQEG","QMLEWTUZCLGODULKCEIUBUIXYNCBWH","YOVKYUGRANDMOTHERELCHKMRUMPIET","HEFWDBEQKNSIZYDEJJLSIAGTORELMM","RARYNINMZXZDZIVXKHMPKAROENGYAD","LIFEARDRODFEMDUPVJOEPOLSDGMAWE","JJTZCTTAPCTEHFXZAYMAPESWUKFEWJ","DOYLSNNKAPTGKKOSUBHPXQORKDSKNZ","EEGGSOLBMUMUCNTWTLOJROTCADEKIT","PHXSVCKOWEQEOXCTHTEOPSLDREZMAI","OHJDFHRTHYNIXBEMOJFMPAGKYTALXY","SRJAMPQSFCFWLSAXRGABYYTSVVNGYS","IOJEQHDJXGDUKLVDIBOHKQZYITKTYB","THSRJYFKBCSQVVPTTTSHSVRDGGREEN","KRBECLAXEOEYTVSKYKRQKGVKPKFVUP","NKXMDTQQWAOVEKECNANIFRLBKAPFBR","XSROXJZEUSTLKOQOWWDXQGBAPOYKWP","HAGTNVSJMFHPCTJPEHMHZYNNJQEONR","TSLSWPLZNDOAUBSTODCNCIBEYMPVGU","FTQUPRIORITYBEUPRMYIDVIMTRXUBE","ERICYMDAVJGPKSRLDOALWVFWLAZDYK","IRYZEXGGCCAAGOCLBHSVVDXNJALKEN","EEJNRIZOYJCRCPLVZDFAILNGAMYHVB","GWPEVRYYEVHEBBAYEOHSRPEANRIEXQ","ENTYHVHQOJDULZMCGXKUODTCSGARRR","NQSWGXZJCUJRACUZAZUMKGOKHCDAIE","RZILHBBJREJGDVCJJDHIWWYGRUOBKG"],
      words:["ACTOR","AFTERMATH","ANSWER","AUTHORITY","BLADE","BUCKET","BULB","CAKES","CANCEL","CANDY","CLAM","CONTRIBUTION","CORN","CUSTOMER","DAY","DEPOSIT","EGGS","ENVIRONMENT","FAIL","FINANCE","FOREVER","GAP","GRANDMOTHER","GREEN","HIGH","HOLD","LAYER","MAKE","NECK","NIGHT","OFFICIAL","OPPORTUNITY","OUTCOME","PAY","POET","PRESS","PRIORITY","PROCEDURE","PROMPT","SANDWICH","SEED","SHOE","SLEEP","SODA","SORT","STRUGGLE","TOES"],
    },
    "Large":{
      puzzle:["TCBYWZTQFGGIQRCNMYKLJUIWQKNVDKVKCYBIJRXK", "YJMHKIXNXAMAUEJZCUKJFXIYAYIEVCHXKXMUCVHV", "YTZCDHIIWQUTAFKOUXJDYFFGTWCLEHAUOUAQULKR", "NEXTJBDWYHERNMEEKDZQKNQZLJKJAXKHNIEYSKDO", "EZAYQGVCHJZOOFNYJCSEOZWACCWLKVEMGFNHWBIE", "PSZNPFGVPALNNOIMPQRWYFDSTACEGGIQOWPCRRKJ", "LHPXBSIWDBMFQCCUKIWADILJITYAKQLBUJISGDVL", "NUJSOWEXXFEKMMESDPMHOEWFBRELEWGHNOIKXOGN", "TXRNAVGYVDPJMWVMANJANRAIAEPSJLWIGDVDKRSL", "CUCJHDSQTYUHFFRVTZIXDYWZAGRJAQVSPOKTAEMN", "XUDUJXOGIHUMHJPERPMYXQRTTFGEISMCYFNGUQWE", "KXKIIZNFHWOGXFJBKOSVNVTBZJFNCVHMVGGPYRNJ", "VUAESSZFKRRVEJSIXXAJRVUGQPVBOORQXOEGCHJB", "LPEVXTCBJUWNXNVFTOXWCGQBQPXOMBNTWUCTLYPT", "BRPALHWQILXPFSRIZMVIABQJCXPOXKPSLZVVZSET", "EBHFGDVWAAPPGWCPWXOXTFVKBCYSXVONNWFWUSZD", "DFGETWLARDHPTJQJSQOPZFHEQNDQALPAVFDVPKNH", "PNYGKKYGHOKAFEVYJCTMCLPBSEEUNAFOJIBGYFWG", "KHOCCATXDSIUKWARBAFKBVGLFQWQNQETUGFMBHSB", "HGCYIBPDAHCOYPVUATCJXVPTZWIBDMFGYAWVCPGE", "SVQOURGJBEESIANBOQUMKTZKZBXAGPKDMQAKFGVY", "ANXXNMMSLGDWZNDLNGUIPDJDQYGFZURBBKZSETQM", "ACXLOZQNSXERRNDWXRSFAGMAVUFPHNRWKMBUIJDQ", "FYEMTVFZBPILZTBHIZIZKRMQXFPZCLQLILITFOWC", "WYACVQNGOSMGNWUIZBAJGAOBGKIHXBMLBQVDOYKR", "DABMMFOCXCYNSFNHTIHHFVJQGKXTBOZCTATWKTOI", "SRRAUTFHZZCGCRYMYCNBNVABSIKDUDLQSXFUIQRX", "YSFGXAKJMAFMWDONDFYJUAMNDKWMZBJJGMCZBBMM", "FAHHMULMPPAHXGCYAWGLLQBTWGPRYVJEEQQNVKDH", "GVOSDEZGVRDPSRDCEGUQVBFFCAPCXIPISUZXBQDD", "WGGPTNLATFGUDNIZCNBTBIMZNQIMUMVRCWKQEILR", "MJMITLCQCZNAYZMARSIZCXJLTFOKGJOFULOBUOYH", "ITPSVSGDYHVJNHEIZJGAUPALBOIZEOCOTAAZOKHZ", "SUAPNLGLTRQTVIFUAIJTVRHYOOKDFVLGAZVAKLTN", "BUUIECJUDJZITCMDFMJZZTKDXHPNEJMOWRFCJRZP", "JFKOQIAOAAMFRKANODZQMZACEWKGSDBSYOBWVDEV", "BPLLGCYRPBEVTBVLJCNDVJMSWZJJVNPXJONRGYEU", "KKYXHTPNNECNBHHZGFYDXCKVBEDFFKRXXLILEWQS", "KOPSDFKVQQHOOGOVMOTQNJTWDBOXDFGTXKCMNDLW", "XKQSRUMLIQECWKHYJVDTNSAHVJQAPALJGKGPJOSS"],
      words:["account","achiever","acoustics","act","action","activity","actor","addition","adjustment","advertisement","advice","aftermath","afternoon","afterthought","agreement","air","airplane","airport","alarm","amount","amusement","anger","angle","animal ","answer","ant","ants ","apparatus","apparel","apple","apples ","appliance","approval","arch","argument","arithmetic","arm","army","art","attack","attempt","attention","attraction","aunt","authority","babies ","baby ","back","badge","bag","bait","balance","ball","balloon","balls ","banana","band","base","baseball","basin","basket","basketball","bat","bath","battle","bead","beam","bean","bear","bears ","beast","bed","bedroom","beds ","bee","beef","beetle","beggar","beginner","behavior","belief","believe","bell","bells ","berry","bike","bikes ","bird","birds ","birth","birthday","bit","bite","blade","blood","blow","board","boat","boats ","body","bomb","bone","book","books ","boot","border","bottle","boundary","box","boy","boys ","brain","brake","branch","brass","bread","breakfast","breath","brick","bridge","brother","brothers ","brush","bubble","bucket","building","bulb","bun","burn","burst","bushes","business","butter","button","cabbage","cable","cactus","cake","cakes ","calculator","calendar","camera","camp","can","cannon","canvas","cap","caption","car ","card","care","carpenter","carriage","cars ","cart","cast","cat","cats ","cattle","cause","cave","celery","cellar","cemetery","cent","chain","chair ","chairs ","chalk","chance","change","channel","cheese","cherries","cherry","chess","chicken ","chickens ","children","chin","church","circle","clam","class","clock","clocks ","cloth","cloud","clouds ","clover","club","coach","coal","coast","coat","cobweb","coil","collar","color","comb","comfort","committee","company","comparison","competition","condition","connection","control","cook","copper","copy","cord","cork","corn ","cough","country","cover","cow","cows ","crack","cracker","crate","crayon","cream","creator","creature","credit","crib","crime","crook","crow","crowd","crown","crush","cry","cub","cup","current","curtain","curve","cushion","dad","daughter","day","death","debt","decision","deer","degree","design","desire","desk","destruction","detail","development","digestion","dime","dinner","dinosaurs ","direction","dirt","discovery","discussion","disease","disgust","distance","distribution","division","dock","doctor","dog","dogs ","doll","dolls ","donkey","door","downtown","drain","drawer","dress","drink","driving","drop","drug","drum","duck ","ducks ","dust","ear","earth","earthquake","edge","education","effect","egg","eggnog","eggs ","elbow","end","engine","error","event","example","exchange","existence","expansion","experience","expert","eye","eyes","face","fact","fairies ","fall","family","fan","fang ","farm","farmer ","father","faucet","fear","feast","feather","feeling","feet","fiction","field","fifth","fight","finger","fire ","fireman","fish","flag","flame","flavor","flesh","flight","flock","floor","flower","flowers ","fly","fog","fold","food","foot","force","fork","form","fowl","frame","friction","friend","friends ","frog","frogs ","front","fruit","fuel","furniture","alley","game","garden","gate","geese","ghost","giants ","giraffe","girl","girls ","glass","glove","glue","goat","gold","goldfish","good-bye ","goose","government","governor","grade","grain","grandfather","grandmother","grape","grass","grip","ground","group","growth","guide","guitar","gun","hair","haircut","hall","hammer","hand","hands ","harbor","harmony","hat","hate","head","health","hearing","heart","heat","help","hen","hill ","history","hobbies","hole","holiday","home ","honey","hook","hope","horn","horse","horses ","hose","hospital","hot","hour","house","houses ","humor","hydrant","ice","icicle","idea","impulse","income","increase","industry","ink","insect","instrument","insurance","interest","invention","iron","island","jail","jam","jar","jeans","jelly","jellyfish","jewel","join","joke","journey","judge","juice","jump","kettle","key","kick","kiss","kite","kitten","kittens ","kitty ","knee","knife","knot","knowledge","laborer","lace","ladybug","lake","lamp","land","language","laugh","lawyer","lead","leaf","learning","leather","leg ","legs","letter","letters ","lettuce","level","library","lift","light","limit","line","linen","lip","liquid","list","lizards ","loaf","lock","locket","look","loss","love","low","lumber","lunch","lunchroom","machine","magic","maid","mailbox","man","manager","map","marble","mark","market","mask","mass","match","meal","measure","meat","meeting","memory","men","metal","mice ","middle","milk","mind","mine","minister","mint","minute","mist","mitten","mom","money","monkey","month","moon","morning","mother","motion","mountain","mouth","move","muscle","music","nail","name","nation","neck","need","needle","nerve","nest ","net","news","night","noise","north","nose","note","notebook","number","nut","oatmeal","observation","ocean","offer","office","oil","operation","opinion","orange","oranges ","order","organization","ornament","oven","owl","owner","page","pail","pain","paint","pan","pancake","paper","parcel","parent","park","part","partner","party","passenger","paste","patch","payment","peace","pear","pen","pencil","person","pest","pet","pets ","pickle","picture","pie","pies ","pig","pigs ","pin","pipe","pizzas ","place","plane","planes ","plant","plantation","plants ","plastic","plate","play","playground","pleasure","plot","plough","pocket","point","poison","police","polish","pollution","popcorn","porter","position","pot","potato","powder","power","price","print","prison","process","produce","profit","property","prose","protest","pull","pump","punishment","purpose","push","quarter","quartz","queen","question","quicksand","quiet","quill","quilt","quince","quiver","rabbit ","rabbits ","rail","railway","rain","rainstorm","rake","range","rat","rate","ray","reaction","reading","reason","receipt","recess","record","regret","relation","religion","representative","request","respect","rest","reward","rhythm","rice","riddle","rifle","ring","rings ","river","road","robin ","rock","rod","roll","roof","room","root","rose","route","rub","rule","run","sack","sail","salt","sand","scale","scarecrow","scarf","scene","scent","school","science","scissors","screw","sea","seashore","seat","secretary","seed","selection","self","sense","servant","shade","shake","shame","shape","sheep","sheet","shelf","ship","shirt","shock","shoe","shoes ","shop","show","side","sidewalk","sign","silk","silver","sink","sister","sisters ","size","skate","skin","skirt","sky","slave","sleep","sleet","slip","slope","smash","smell","smile","smoke","snail","snails ","snake","snakes ","sneeze","snow","soap","society","sock","soda","sofa","son","song","songs ","sort","sound","soup","space","spade","spark","spiders ","sponge","spoon","spot","spring","spy","square","squirrel","stage","stamp","star","start","statement","station","steam","steel","stem","step","stew","stick","sticks ","stitch","stocking","stomach","stone","stop","store","story","stove","stranger","straw","stream","street","stretch","string","structure","substance","sugar","suggestion","suit","summer","sun","support","surprise","sweater","swim","swing","system","table","tail","talk","tank","taste","tax","teaching","team","teeth ","temper","tendency","tent","territory","test","texture","theory","thing","things ","thought","thread","thrill","throat","throne","thumb","thunder","ticket","tiger","time","tin","title","toad","toe","toes","tomatoes ","tongue","tooth","toothbrush","toothpaste","top ","touch","town","toy ","toys ","trade","trail","train","trains ","tramp","transport","tray","treatment","tree","trees ","trick","trip","trouble","trousers","truck","trucks ","tub","turkey","turn","twig","twist","umbrella","uncle","underwear","unit","use","vacation","value","van","vase","vegetable","veil","vein","verse","vessel","vest","view","visitor","voice","volcano","volleyball","voyage","walk","wall","war","wash","waste","watch","water","wave","waves ","wax","way","wealth","weather","week","weight","wheel","whip","whistle","wilderness","wind ","window ","wine","wing","winter","wire","wish","woman","women","wood","wool","word","work","worm","wound","wren","wrench","wrist","writer","writing","yak","yam","yard","yarn","year","yoke","zebra ","zephyr","zinc","zipper","zoo","people","world","information","computer","thanks","method","data","understanding","law","literature","problem","software","ability","economics","internet","television","nature","product","temperature","investment","area","media","community","definition","safety","quality","management","player","variety","video","security","exam","movie","equipment","physics","analysis","policy","series","basis","boyfriend","strategy","technology","freedom","environment","child","instance","truth","marketing","university","article","department","difference","goal","audience","fishing","marriage","user","combination","failure","meaning","medicine","philosophy","teacher","communication","chemistry","disk","energy","role","advertising","location","success","apartment","math","moment","painting","politics","shopping","student","entertainment","population","president","category","cigarette","context","introduction","opportunity","performance","driver","length","magazine","newspaper","relationship","cell","dealer","finding","member","message","phone","appearance","association","concept","customer","housing","inflation","mood","effort","expression","importance","reality","responsibility","situation","skill","application","city","county","depth","estate","foundation","perspective","photo","recipe","studio","topic","collection","depression","imagination","passion","percentage","resource","setting","ad","agency","college","criticism","description","patience","solution","administration","aspect","attitude","director","personality","psychology","recommendation","response","storage","version","alcohol","complaint","contract","emphasis","highway","membership","possession","preparation","steak","union","cancer","currency","employment","engineering","entry","interaction","mixture","preference","region","republic","tradition","virus","classroom","delivery","device","difficulty","drama","election","football","guidance","hotel","priority","protection","tension","variation","anxiety","atmosphere","awareness","candidate","climate","confusion","construction","elevator","emotion","employee","employer","guest","height","leadership","mall","recording","sample","transportation","charity","cousin","disaster","editor","efficiency","excitement","extent","feedback","homework","leader","outcome","permission","presentation","promotion","reflection","refrigerator","resolution","revenue","session","singer","tennis","bonus","cabinet","childhood","clothes","coffee","drawing","initiative","judgment","lab","measurement","mode","mud","poetry","possibility","procedure","ratio","restaurant","satisfaction","sector","signature","significance","vehicle","volume","wife","accident","appointment","arrival","assumption","chapter","conversation","database","enthusiasm","explanation","farmer","historian","injury","instruction","maintenance","manufacturer","perception","poem","presence","proposal","reception","replacement","revolution","speech","tea","village","warning","winner","worker","assistance","buyer","chest","chocolate","conclusion","contribution","cookie","courage","establishment","examination","garbage","grocery","impression","improvement","independence","inspection","inspector","king","ladder","menu","penalty","piano","profession","professor","quantity","requirement","salad","supermarket","weakness","wedding","affair","ambition","analyst","assignment","assistant","bathroom","beer","celebration","championship","cheek","client","consequence","departure","diamond","fortune","friendship","funeral","gene","girlfriend","indication","intention","lady","midnight","negotiation","obligation","pizza","platform","poet","recognition","reputation","sir","speaker","surgery","sympathy","tale","trainer","youth","film","while","study","life","job","type","home","economy","state","radio","course","risk","fat","training","top","practice","research","service","piece","web","boss","sport","fun","term","focus","matter","kind","soil","access","future","site","demand","exercise","image","case","age","bad","result","section","mouse","cash","nothing","period","plan","subject","stock","figure","model","source","beginning","program","chicken","feature","material","car","object","rent","speed","style","bank","craft","half","inside","outside","standard","bus","fire","pressure","stress","advantage","benefit","issue","cycle","item","review","screen","discipline","medium","share","black","bottom","choice","gift","impact","tool","wind","address","average","career","culture","task","contact","network","date","link","post","capital","challenge","shot","couple","debate","exit","function","lack","living","theme","track","click","gas","influence","notice","damage","pair","savings","staff","target","text","animal","author","budget","discount","file","lesson","officer","phase","reference","register","bowl","campaign","character","evidence","maximum","novel","option","pack","plenty","baby","background","carry","dish","factor","joint","master","red","strength","traffic","appeal","chart","gear","ideal","kitchen","log","principle","relative","sale","season","signal","spirit","belt","bench","commission","minimum","path","progress","project","south","status","stuff","tour","blue","confidence","dot","dream","duty","essay","fee","finance","luck","stable","storm","beach","blank","catch","consideration","crew","interview","kid","mission","score","sex","shower","tone","window","agent","block","contest","corner","court","district","east","garage","guarantee","implement","layer","lecture","lie","manner","parking","profile","routine","schedule","swimming","telephone","tip","airline","bill","bother","code","designer","dimension","ease","emergency","evening","extension","gap","horror","host","husband","loan","mistake","occasion","package","patient","pause","phrase","proof","race","relief","sentence","shoulder","tourist","towel","west","aside","associate","bet","breast","buddy","bunch","chip","cross","document","draft","god","golf","habit","landscape","league","mail","mess","native","opening","pattern","pool","pound","salary","shelter","tackle","trust","assist","bake","bar","blame","chair","closet","clue","comment","conference","devil","diet","jacket","monitor","mortgage","nurse","pace","panic","peak","row","sandwich","spite","spray","till","transition","weekend","welcome","bend","bicycle","blind","candle","clerk","concert","counter","harm","load","mirror","pension","purple","ruin","slice","specialist","stroke","switch","trash","tune","zone","award","bid","bitter","bug","candy","carpet","champion","engineer","entrance","fault","guy","hell","highlight","incident","jury","leg","mate","motor","passage","pride","priest","prize","promise","resident","resort","rope","scheme","script","tower","witness","a","you","it","will","if","many","most","other","make","good","go","great","being","few","might","still","public","read","keep","give","human","local","general","she","specific","long","feel","high","tonight","put","common","set","simple","past","big","possible","particular","today","major","personal","national","cut","natural","physical","try","check","second","call","pay","let","single","individual","ask","buy","guard","hold","main","potential","professional","international","travel","alternative","following","special","working","whole","dance","excuse","cold","commercial","purchase","deal","primary","worth","necessary","positive","search","present","spend","creative","tell","cost","drive","green","glad","remove","return","complex","due","effective","regular","reserve","independent","leave","original","reach","serve","beautiful","charge","active","break","negative","safe","stay","visit","visual","affect","report","rise","white","beyond","junior","pick","unique","anything","classic","final","mix","private","teach","western","concern","familiar","official","broad","comfortable","gain","maybe","rich","save","stand","young","fail","heavy","hello","listen","valuable","worry","handle","leading","meet","release","sell","finish","normal","press","ride","secret","spread","tough","wait","brown","deep","display","flow","hit","objective","shoot","cancel","chemical","dump","extreme","conflict","eat","fill","formal","opposite","pass","pitch","remote","total","treat","vast","abuse","beat","deposit","raise","somewhere","advance","anywhere","consist","dark","double","draw","equal","fix","hire","internal","kill","sensitive","tap","win","claim","constant","drag","guess","minor","raw","soft","solid","wear","weird","wonder","annual","count","dead","doubt","feed","forever","impress","nobody","repeat","round","sing","slide","strip","whereas","combine","command","dig","divide","equivalent","hang","hunt","initial","march","mention","spiritual","survey","tie","adult","brief","crazy","escape","gather","prior","repair","rough","sad","scratch","sick","strike","employ","external","hurt","illegal","lay","mobile","nasty","ordinary","respond","royal","senior","split","strain","struggle","upper","yellow","convert","crash","dependent","funny","grab","hide","miss","permit","quote","recover","resolve","spare","suspect","sweet","upstairs","usual","abroad","brave","calm","concentrate","estimate","grand","male","prompt","refuse","reveal","rush","shift","shine","steal","suck","surround","anybody","brilliant","dare","dear","delay","drunk","female","hurry","inevitable","invite","neat","pop","punch","quit","reply","resist","rip","silly","spell","stupid","tear","temporary","tomorrow","wake","wrap","yesterday"],
    },
    "Huge":{
      puzzle:Array(100).fill().map(() => Array(100).fill().map(() => String.fromCharCode(65+Math.floor(Math.random()*26))).join('')),
      words:dictionary
    }
  }
  // Make everything capitalized
  Object.values(puzzles).forEach(puzzle => {
    puzzle.words = puzzle.words.map(n => n.trim().toUpperCase())
    puzzle.puzzle = puzzle.puzzle.map(n => n.trim().toUpperCase())
  })

  const canvas = document.querySelector('canvas')
  const ctx = canvas.getContext('2d')
  const padding = 50

  let letterArea
  let savedPuzzle

  function init(){
    canvas.width = window.innerWidth
    canvas.height = window.innerHeight
  }
  function draw(puzzle){
    ctx.clearRect(0,0,canvas.width,canvas.height)
    savedPuzzle = puzzle
    letterArea = Math.min((canvas.height-padding*2)/puzzle[0].length, (canvas.width-padding*2)/puzzle.length,40)
    ctx.font = Math.round(letterArea*.6)+"px verdana"
    ctx.textAlign = "center"
    for(var r = 0; r < puzzle.length; r++){
      for(var c = 0; c < puzzle[r].length; c++){
        ctx.fillText(puzzle[r][c].toUpperCase(),Math.round(letterArea/2+padding+c*letterArea),Math.round(letterArea/2+padding+r*letterArea))
      }
    }
  }
  function getColor(percent){
    var hex = Math.min(Math.round(255*percent),255).toString(16).padStart(2,0)
    return "#"+hex+hex+hex
  }
  function length(sy,sx,ey,ex){
    return Math.max(Math.abs(sy-ey),Math.abs(sx-ex))
  }
  function circle(sy,sx,ey,ex){
    if(!savedPuzzle) throw new Error('Never loaded a puzzle')
    if([sy,ey].find(n => n < 0 || n >= savedPuzzle.length) || [sx,ex].find(n => n < 0 || n >= savedPuzzle[0].length)){
      console.warn('coordinate is out of range')
    } 
    var start = [sy,sx]
    var end = [ey,ex]
    ctx.lineWidth = 2
    var wordLength = length(...start,...end)
    ctx.strokeStyle = getColor(1-wordLength/6)
    var angle = Math.atan2(ey - sy,ex - sx);
    var get = ([x,y]) => [Math.round(letterArea/2+padding+y*letterArea),
      Math.round(letterArea*.3+padding+x*letterArea)]
    var radius = letterArea*.35
    ctx.beginPath()
    ctx.arc(...get(start),radius,angle+Math.PI/2,angle-Math.PI/2)
    ctx.arc(...get(end),radius,angle-Math.PI/2,angle+Math.PI/2)
    ctx.closePath()
    ctx.stroke()
  }

  Object.keys(puzzles).forEach(puzzleName => {
    var button = document.createElement('button')
    button.innerHTML = puzzleName
    button.onclick = function(){
      window.location.hash = puzzleName
      run(puzzleName)
    }
    document.getElementById('buttons').appendChild(button)
  })
  window.addEventListener("load",() => {
    init()
    var puzzleName = window.location.hash ? decodeURI(window.location.hash.slice(1)) : Object.keys(puzzles)[0]
    run(puzzleName)
  })
  function run(puzzleName){
    if(typeof window.solve != 'function'){
      throw new ReferenceError("Solve function needs to be defined")
    }
    if(puzzles[puzzleName] == undefined){
      throw new ReferenceError("Couldn't find that puzzle")
    }
    draw(puzzles[puzzleName].puzzle)
    var start = Date.now()
    var found = window.solve(puzzles[puzzleName].words,puzzles[puzzleName].puzzle)
    var time = Date.now() - start
    if(found){
      console.log(`${puzzleName} Solution Speed: ${time} ms`)
      found.sort((a,b) => length(...a) - length(...b))
      found.forEach(f => circle(...f))
    }
  }
})()